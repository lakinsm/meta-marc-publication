LeukemiaMyelomaRiskAzotemia)
LymphomaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with lymphoma is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskAzotemia)
LeukemiaLymphomaRiskAzotemia <- (counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma))
sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with lymphoma is %.2f percent, and the relative risk of azotemia with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskAzotemia)
LeukemiaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with leukemia to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LeukemiaMyelomaRiskAzotemia)
LymphomaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with lymphoma is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskAzotemia)
LeukemiaLymphomaRiskProteinuria <- (counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma))
sprintf('The risk of proteinuria with leukemia is %.2f percent, the risk of proteinuria with lymphoma is %.2f percent, and the relative risk of proteinuria with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskProteinuria)
LeukemiaMyelomaRiskProteinuria <- (counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma))
sprintf('The risk of proteinuria with leukemia is %.2f percent, the risk of proteinuria with multiple myeloma is %.2f percent, and the relative risk of proteinuria with leukemia to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma)),
LeukemiaMyelomaRiskProteinuria)
LymphomaMyelomaRiskProteinuria <- (counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma))
sprintf('The risk of proteinuria with lymphoma is %.2f percent, the risk of proteinuria with multiple myeloma is %.2f percent, and the relative risk of proteinuria with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskProteinuria)
LeukemiaLymphomaRiskAzotemia <- (counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma))
sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with lymphoma is %.2f percent, and the relative risk of azotemia with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskAzotemia)
LeukemiaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with leukemia to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LeukemiaMyelomaRiskAzotemia)
LymphomaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with lymphoma is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskAzotemia)
LeukemiaLymphomaRiskProteinuria <- (counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma))
sprintf('The risk of proteinuria with leukemia is %.2f percent, the risk of proteinuria with lymphoma is %.2f percent, and the relative risk of proteinuria with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskProteinuria)
LeukemiaMyelomaRiskProteinuria <- (counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma))
sprintf('The risk of proteinuria with leukemia is %.2f percent, the risk of proteinuria with multiple myeloma is %.2f percent, and the relative risk of proteinuria with leukemia to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma)),
LeukemiaMyelomaRiskProteinuria)
LymphomaMyelomaRiskProteinuria <- (counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma))
sprintf('The risk of proteinuria with lymphoma is %.2f percent, the risk of proteinuria with multiple myeloma is %.2f percent, and the relative risk of proteinuria with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskProteinuria, width=80)
options(width=80)
LeukemiaLymphomaRiskAzotemia <- (counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma))
sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with lymphoma is %.2f percent, and the relative risk of azotemia with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskAzotemia)
LeukemiaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with leukemia to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LeukemiaMyelomaRiskAzotemia)
LymphomaMyelomaRiskAzotemia <- (counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma))
sprintf('The risk of azotemia with lymphoma is %.2f percent, the risk of azotemia with multiple myeloma is %.2f percent, and the relative risk of azotemia with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyAzotemia']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskAzotemia)
LeukemiaLymphomaRiskProteinuria <- (counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma))
sprintf('The risk of proteinuria with leukemia is %.2f percent, the risk of proteinuria with lymphoma is %.2f percent, and the relative risk of proteinuria with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskProteinuria)
LeukemiaMyelomaRiskProteinuria <- (counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma))
sprintf('The risk of proteinuria with leukemia is %.2f percent, the risk of proteinuria with multiple myeloma is %.2f percent, and the relative risk of proteinuria with leukemia to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyProteinuria']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma)),
LeukemiaMyelomaRiskProteinuria)
LymphomaMyelomaRiskProteinuria <- (counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)) /
(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma))
sprintf('The risk of proteinuria with lymphoma is %.2f percent, the risk of proteinuria with multiple myeloma is %.2f percent, and the relative risk of proteinuria with lymphoma to multiple myeloma is %.2f.',
100*(counts[DiseaseType == 'Lymphoma'][['AnyProteinuria']] / sum(disease_association$lymphoma)),
100*(counts[DiseaseType == 'Multiple Myeloma'][['AnyProteinuria']] / sum(disease_association$myeloma)),
LymphomaMyelomaRiskProteinuria, width=80)
install.packages('str_pad')
strwrap(sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with lymphoma is %.2f percent, and the relative risk of azotemia with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskAzotemia), width=10)
paste(strwrap(sprintf('The risk of azotemia with leukemia is %.2f percent, the risk of azotemia with lymphoma is %.2f percent, and the relative risk of azotemia with leukemia to lymphoma is %.2f.',
100*(counts[DiseaseType == 'Leukemia'][['AnyAzotemia']] / sum(disease_association$leukemia)),
100*(counts[DiseaseType == 'Lymphoma'][['AnyAzotemia']] / sum(disease_association$lymphoma)),
LeukemiaLymphomaRiskAzotemia), width=80), collapse='\n')
counts
disease_association
colSums(disease_association)
tapply(disease_association$any_azotemia, disease_association$myeloma, sum)
disease_association[, .SD, .SDcols=c('any_azotemia', 'myeloma')]
sum(disease_association$any_azotemia[disease_association$myeloma == 1])
sum(disease_association$persistent_azotemia[disease_association$myeloma == 1])
leukemia <- c(
0, 0, 0,
0, 0, 0,
0, 0, 0,
0, 0, 0,
1, 0, 0,
0, 0
)
myeloma <- c(
1, 1, 1,
1, 0, 0,
0, 1, 1,
1, 1, 0,
0, 1, 1,
1, 1
)
lymphoma <- c(
0, 0, 0,
0, 0, 0,
0, 0, 0,
0, 0, 1,
0, 0, 1,
0, 0
)
transient_proteinuria <- c(
0, 0, 0,
0, 0, 0,
0, 0, 0,
0, 0, 1,
0, 1, 0,
0, 0
)
persistent_proteinuria <- c(
1, 0, 0,
0, 0, 0,
0, 0, 0,
0, 0, 0,
1, 0, 0,
1, 0
)
any_proteinuria <- c(
1, 0, 0,
1, 1, 1,
1, 1, 0,
1, 0, 1,
1, 1, 1,
1, 1
)
transient_azotemia <- c(
1, 0, 0,
0, 0, 0,
0, 0, 0,
0, 0, 0,
0, 0, 0,
0, 1
)
persistent_azotemia <- c(
0, 0, 0,
1, 0, 0,
0, 0, 0,
0, 0, 0,
1, 1, 0,
0, 0
)
any_azotemia <- c(
1, 0, 0,
1, 0, 0,
0, 0, 0,
0, 0, 0,
1, 1, 0,
0, 1
)
disease_association <- data.table(
leukemia=leukemia,
lymphoma=lymphoma,
myeloma=myeloma,
any_proteinuria=any_proteinuria,
transient_proteinuria=transient_proteinuria,
persistent_proteinuria=persistent_proteinuria,
any_azotemia=any_azotemia,
transient_azotemia=transient_azotemia,
persistent_azotemia=persistent_azotemia
)
tapply(disease_association$any_azotemia, disease_association$leukemia, sum)
tapply(disease_association$any_azotemia, disease_association$lymphoma, sum)
tapply(disease_association$any_azotemia, disease_association$myeloma, sum)
tapply(disease_association$persistent_azotemia, disease_association$leukemia, sum)
tapply(disease_association$persistent_azotemia, disease_association$lymphoma, sum)
tapply(disease_association$persistent_azotemia, disease_association$myeloma, sum)
tapply(disease_association$transient_azotemia, disease_association$leukemia, sum)
tapply(disease_association$transient_azotemia, disease_association$lymphoma, sum)
tapply(disease_association$transient_azotemia, disease_association$myeloma, sum)
tapply(disease_association$any_proteinuria, disease_association$leukemia, sum)
tapply(disease_association$any_proteinuria, disease_association$lymphoma, sum)
tapply(disease_association$any_proteinuria, disease_association$myeloma, sum)
tapply(disease_association$persistent_proteinuria, disease_association$leukemia, sum)
tapply(disease_association$persistent_proteinuria, disease_association$lymphoma, sum)
tapply(disease_association$persistent_proteinuria, disease_association$myeloma, sum)
tapply(disease_association$transient_proteinuria, disease_association$leukemia, sum)
tapply(disease_association$transient_proteinuria, disease_association$lymphoma, sum)
tapply(disease_association$transient_proteinuria, disease_association$myeloma, sum)
counts <- data.table(
DiseaseType = c('Leukemia', 'Lymphoma', 'Multiple Myeloma'),
AnyAzotemia = c(1, 0, 4),
PersistentAzotemia = c(1, 0, 2),
TransientAzotemia = c(0, 0, 2),
AnyProteinuria = c(1, 2, 8),
PersistentProteinuria = c(1, 0, 2),
TransientProteinuria = c(0, 1, 1)
)
counts
counts
as.Date('2017-09-01') - sys.Date()
as.Date('2017-09-01') - sys.Time()
as.Date('2017-09-01') - sys.time()
as.Date('2017-09-01') - Sys.Date()
Sys.Date() - as.Date('2017-09-01')
103 / 30
## Exploratory analysis and publication figure generation for
## Meta-MARC HMM data.  Test set data for Soil, Pediatric, and NCBA1
## are in long format in the analytic_data/mmarc_publication_analytic_data.csv
## file, and the simulation output data is in the
## analytic_data/mmarc_publication_simulation_results.csv file.
library(ggplot2)
library(RColorBrewer)
library(data.table)
library(scales)
setwd("/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/")
abund_data <- data.table(read.csv('analytic_data/mmarc_publication_analytic_data.csv'))
ncba_metadata <- data.table(read.csv('metadata/PRJNA292471_metadata.csv'))
colnames(abund_data) <- c('TestSet', 'SampleName', 'DantasSampleSet', 'TruthLabel', 'Pipeline', 'HMMGroup',
'AnnotationLevel', 'NodeName', 'Abundance')
abund_data$NodeName <- gsub('MLS', 'Macrolides, Lincosamides,\nStreptogrammins', as.character(abund_data$NodeName))
abund_data$NodeName <- gsub('betalactams', 'beta-lactams', as.character(abund_data$NodeName))
abund_data$NodeName <- gsub('Cationic antimicrobial peptides',
'Cationic Antimicrobial Peptides', as.character(abund_data$NodeName))
abund_data$NodeName <- gsub('Multi-drug resistance',
'Multi-drug Resistance', as.character(abund_data$NodeName))
pattern <- unique(abund_data$TruthLabel[!is.na(abund_data$TruthLabel)])
replace <- as.character(c(
"beta-lactams",
"Phenicol",
"beta-lactams",
"Glycopeptides",
"beta-lactams",
"Aminoglycosides",
"beta-lactams",
"beta-lactams",
"beta-lactams",
"Tetracyclines",
"Trimethoprim",
"Trimethoprim",
"Tetracyclines",
"Phenicol",
"beta-lactams",
"Glycopeptides",
"beta-lactams",
"Tetracyclines",
"beta-lactams",
"Tetracyclines",
"Trimethoprim",
"beta-lactams",
"beta-lactams",
"beta-lactams",
"beta-lactams",
"Aminoglycosides"
))
transl_table <- data.table(TruthLabel=pattern, AnalyticTruthLabel=replace)
setkey(transl_table, TruthLabel)
transl_table
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
temp3
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
temp3
temp3$Method <- translpipe[temp3$Method]
png('graphs/dantas_class_all_samples.png', width=1200, height=900)
g <- ggplot(temp3, aes(x=NodeName, y=SumAbundance, fill=Method)) +
geom_bar(stat='identity', position='dodge') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=0),
axis.text.y=element_text(size=20),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) +
xlab('\nAMR Drug Class') + ylab('Abundance\n') +
scale_fill_brewer(palette = 'Set2', drop=F) + scale_y_continuous(labels = comma)
print(g + ggtitle(paste('AMR Class Abundance by Method\nSoil and Pediatric Test Sets')))
dev.off()
png('graphs/dantas_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
temp3
translpipe[temp3$Method]
translpipe <- c('MMARC'='Meta-MARC HTS', 'MMARC-assembled'='Meta-MARC Assembly', 'Alignment'='Alignment', 'Resfams'='Resfams',
'Meta-MARC HTS'='Meta-MARC HTS', 'Meta-MARC Assembly'='Meta-MARC Assembly')
translpipe[temp3$Method]
temp3$Method <- translpipe[temp3$Method]
png('graphs/dantas_class_all_samples.png', width=1200, height=900)
g <- ggplot(temp3, aes(x=NodeName, y=SumAbundance, fill=Method)) +
geom_bar(stat='identity', position='dodge') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=0),
axis.text.y=element_text(size=20),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) +
xlab('\nAMR Drug Class') + ylab('Abundance\n') +
scale_fill_brewer(palette = 'Set2', drop=F) + scale_y_continuous(labels = comma)
print(g + ggtitle(paste('AMR Class Abundance by Method\nSoil and Pediatric Test Sets')))
dev.off()
png('graphs/dantas_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
temp$Method
debugSource('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
temp
debugSource('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
temp
performance_mmarc_dantas_class_data
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
performance_mmarc_dantas_class_data
performance_mmarc_dantas_class_data$Pipeline
levels(performance_mmarc_dantas_class_data_plot$Pipeline) <- c('Alignment', 'Meta-MARC HTS', 'Meta-MARC Assembly', 'Resfams')
png('graphs/mmarc_dantas_performance_class_all_samples.png', width=1200, height=900)
g <- ggplot(performance_mmarc_dantas_class_data, aes(x=AnalyticTruthLabel, y=PerformancePercent)) +
geom_boxplot() + geom_jitter(width=0.1, height=0, size=1) +
facet_grid(Pipeline ~ TestSet, switch='y') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=180),
axis.text.y=element_text(size=16),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) + scale_y_continuous(labels = comma) +
xlab('\nFunctional Metagenomic Truth Label') + ylab('Percent of Reads On-Target\n')
print(g + ggtitle(paste('Percent of Hits On-Target for each Truth Label\nby Test Set and Pipeline\n')))
dev.off()
png('graphs/mmarc_dantas_performance_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
performance_mmarc_dantas_class_data_plot <- performance_mmarc_dantas_class_data
levels(performance_mmarc_dantas_class_data_plot$Pipeline) <- c('Alignment', 'Meta-MARC HTS', 'Meta-MARC Assembly', 'Resfams')
png('graphs/mmarc_dantas_performance_class_all_samples.png', width=1200, height=900)
g <- ggplot(performance_mmarc_dantas_class_data, aes(x=AnalyticTruthLabel, y=PerformancePercent)) +
geom_boxplot() + geom_jitter(width=0.1, height=0, size=1) +
facet_grid(Pipeline ~ TestSet, switch='y') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=180),
axis.text.y=element_text(size=16),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) + scale_y_continuous(labels = comma) +
xlab('\nFunctional Metagenomic Truth Label') + ylab('Percent of Reads On-Target\n')
print(g + ggtitle(paste('Percent of Hits On-Target for each Truth Label\nby Test Set and Pipeline\n')))
dev.off()
png('graphs/mmarc_dantas_performance_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
png('graphs/mmarc_dantas_performance_class_all_samples.png', width=1200, height=900)
g <- ggplot(performance_mmarc_dantas_class_data_plot, aes(x=AnalyticTruthLabel, y=PerformancePercent)) +
geom_boxplot() + geom_jitter(width=0.1, height=0, size=1) +
facet_grid(Pipeline ~ TestSet, switch='y') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=180),
axis.text.y=element_text(size=16),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) + scale_y_continuous(labels = comma) +
xlab('\nFunctional Metagenomic Truth Label') + ylab('Percent of Reads On-Target\n')
print(g + ggtitle(paste('Percent of Hits On-Target for each Truth Label\nby Test Set and Pipeline\n')))
dev.off()
png('graphs/mmarc_dantas_performance_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
performance_mmarc_dantas_class_data2$Pipeline
temp$Pipeline
temp
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
temp_plot$Pipeline
dev.off()
png('graphs/mmarc_dantas_abundance_class_all_samples.png', width=1200, height=900)
g <- ggplot(temp_plot, aes(x=AnalyticTruthLabel, fill=Pipeline)) +
geom_bar(data=temp, aes(y=TotalReadsIdentified), position='dodge', stat='identity') +
geom_point(data=temp, aes(y=NumberReadsOnTarget), position=position_dodge(width=0.9), shape=3, size=6) +
facet_wrap(~TestSet, nrow=1, ncol=2, scale='free_y') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=0),
axis.text.y=element_text(size=20),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) +
xlab('\nFunctional Metagenomic Truth Label') + ylab('Number of Reads Identified\nTotal (bar) and True Positives (crosshair)\n') +
scale_fill_brewer(palette = 'Set2') + scale_y_continuous(labels = comma)
print(g + ggtitle(paste('Total and On-Target Abundance for each Truth Label\nby Test Set and Pipeline\n')))
dev.off()
png('graphs/mmarc_dantas_abundance_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
temp_plot
png('graphs/mmarc_dantas_abundance_class_all_samples.png', width=1200, height=900)
g <- ggplot(temp_plot, aes(x=AnalyticTruthLabel, fill=Pipeline)) +
geom_bar(data=temp_plot, aes(y=TotalReadsIdentified), position='dodge', stat='identity') +
geom_point(data=temp_plot, aes(y=NumberReadsOnTarget), position=position_dodge(width=0.9), shape=3, size=6) +
facet_wrap(~TestSet, nrow=1, ncol=2, scale='free_y') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.x=element_text(size=20),
strip.text.y=element_text(size=20, angle=0),
axis.text.y=element_text(size=20),
axis.text.x=element_text(size=20, angle=45, hjust=1),
axis.title.x=element_text(size=24),
axis.title.y=element_text(size=24),
legend.position="bottom",
panel.margin=unit(0.1, "lines"),
plot.title=element_text(size=30, hjust=0.5),
legend.text=element_text(size=18),
legend.title=element_blank()) +
xlab('\nFunctional Metagenomic Truth Label') + ylab('Number of Reads Identified\nTotal (bar) and True Positives (crosshair)\n') +
scale_fill_brewer(palette = 'Set2') + scale_y_continuous(labels = comma)
print(g + ggtitle(paste('Total and On-Target Abundance for each Truth Label\nby Test Set and Pipeline\n')))
dev.off()
png('graphs/mmarc_dantas_abundance_class_all_samples_notitle.png', width=1200, height=900)
print(g)
dev.off()
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/mismatch_regression.R')
install.packages('arm')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/mismatch_regression.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/mismatch_regression.R')
rdata_class_plot
rdata_class_plot
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/mismatch_regression.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/mismatch_regression.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/mismatch_regression.R')
source('/mnt/manuscripts/CommunicationsBiology_HMM_Publication/meta-marc-publication/scripts/publication_figures.R')
